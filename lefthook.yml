# Lefthook configuration for git hooks
# https://github.com/evilmartians/lefthook
pre-push:
  commands:
    check:
      glob: "*.rs"
      run: cargo fmt --all --check
      stage_fixed: true
    build-release:
      run: cargo build --release --locked
pre-commit:
  parallel: false
  commands:
    lockfile:
      glob: "Cargo.{toml,lock}"
      run: cargo generate-lockfile
      stage_fixed: true
    format:
      glob: "*.rs"
      run: cargo fmt --all
      stage_fixed: true
    lint:
      glob: "*.rs"
      run: cargo clippy --all-targets --all-features -- -D warnings
    pedantic:
      glob: "*.rs"
      run: cargo clippy --all-targets --all-features -- -D warnings -W clippy::pedantic
    test:
      glob: "*.rs"
      run: cargo test --all-features
    build-css:
      glob: "*.{css,rs}"
      run: tailwindcss -i src/public/css/input.css -o src/public/css/output.css --minify
      stage_fixed: true
